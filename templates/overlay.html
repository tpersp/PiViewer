{% extends "base.html" %}
{% block title %}Overlay Configuration{% endblock %}
{% block content %}
<div class="page-section" style="max-width:1200px;">
  <h2>Overlay Configuration</h2>
  <form method="POST" action="{{ url_for('main.overlay_config') }}">
    <div class="cards-container" style="display:flex; flex-wrap:wrap; gap:20px;">
      {% for monitor_name, monitor_cfg in monitors.items() %}
      <div class="card" style="flex: 1 1 300px; margin-bottom:20px; padding:15px; border:1px solid #ccc; border-radius:8px;">
        <h3>{{ monitor_name }} ({{ monitor_cfg.screen_name }})</h3>
        <div class="form-group">
          <label>
            <input type="checkbox" name="{{ monitor_name }}_overlay_enabled" {% if monitor_cfg.overlay and monitor_cfg.overlay.overlay_enabled %}checked{% endif %}>
            Enable Overlay
          </label>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" name="{{ monitor_name }}_clock_enabled" {% if monitor_cfg.overlay and monitor_cfg.overlay.clock_enabled %}checked{% endif %}>
            Show Clock
          </label>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" name="{{ monitor_name }}_weather_enabled" {% if monitor_cfg.overlay and monitor_cfg.overlay.weather_enabled %}checked{% endif %}>
            Show Weather
          </label>
        </div>
        <div class="form-group">
          <label>Clock Font Size:</label>
          <input type="number" name="{{ monitor_name }}_clock_font_size" value="{{ monitor_cfg.overlay.clock_font_size if monitor_cfg.overlay and monitor_cfg.overlay.clock_font_size is defined else 26 }}">
        </div>
        <div class="form-group">
          <label>Weather Font Size:</label>
          <input type="number" name="{{ monitor_name }}_weather_font_size" value="{{ monitor_cfg.overlay.weather_font_size if monitor_cfg.overlay and monitor_cfg.overlay.weather_font_size is defined else 22 }}">
        </div>
        <div class="form-group">
          <label>Font Color:</label>
          <input type="color" name="{{ monitor_name }}_font_color" value="{{ monitor_cfg.overlay.font_color if monitor_cfg.overlay and monitor_cfg.overlay.font_color is defined else '#FFFFFF' }}">
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" name="{{ monitor_name }}_auto_negative_font" {% if monitor_cfg.overlay and monitor_cfg.overlay.auto_negative_font %}checked{% endif %}>
            Auto Negative Font Color
          </label>
        </div>
        <div class="form-group">
          <label>Layout Style:</label>
          <select name="{{ monitor_name }}_layout_style">
            <option value="stacked" {% if monitor_cfg.overlay and monitor_cfg.overlay.layout_style == "stacked" %}selected{% endif %}>Stacked</option>
            <option value="inline" {% if monitor_cfg.overlay and monitor_cfg.overlay.layout_style == "inline" %}selected{% endif %}>Inline</option>
          </select>
        </div>
        <div class="form-group">
          <label>Padding X:</label>
          <input type="number" name="{{ monitor_name }}_padding_x" value="{{ monitor_cfg.overlay.padding_x if monitor_cfg.overlay and monitor_cfg.overlay.padding_x is defined else 8 }}">
        </div>
        <div class="form-group">
          <label>Padding Y:</label>
          <input type="number" name="{{ monitor_name }}_padding_y" value="{{ monitor_cfg.overlay.padding_y if monitor_cfg.overlay and monitor_cfg.overlay.padding_y is defined else 6 }}">
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" name="{{ monitor_name }}_show_desc" {% if monitor_cfg.overlay and monitor_cfg.overlay.show_desc %}checked{% endif %}>
            Show Weather Description
          </label>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" name="{{ monitor_name }}_show_temp" {% if monitor_cfg.overlay and monitor_cfg.overlay.show_temp %}checked{% endif %}>
            Show Temperature
          </label>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" name="{{ monitor_name }}_show_feels_like" {% if monitor_cfg.overlay and monitor_cfg.overlay.show_feels_like %}checked{% endif %}>
            Show Feels Like Temperature
          </label>
        </div>
        <div class="form-group">
          <label>
            <input type="checkbox" name="{{ monitor_name }}_show_humidity" {% if monitor_cfg.overlay and monitor_cfg.overlay.show_humidity %}checked{% endif %}>
            Show Humidity
          </label>
        </div>
      </div>
      {% endfor %}
    </div>
    <div style="text-align:center; margin-top:20px;">
      <button type="submit">Save All Overlay Settings</button>
    </div>
  </form>
  <hr>
  <h3>Preview (for first monitor)</h3>
  <div class="overlay-preview-container" style="border:1px solid #ccc; padding:10px; display:inline-block;">
    <p>Monitor Preview (Scaled to {{ preview_size.width }}x{{ preview_size.height }})</p>
    <div id="overlayPreviewBox" style="position: relative; width: {{ preview_size.width }}px; height: {{ preview_size.height }}px; background: #333;">
      <div id="overlayDraggable" style="position: absolute; left: {{ preview_overlay.left }}px; top: {{ preview_overlay.top }}px; width: {{ preview_overlay.width }}px; height: {{ preview_overlay.height }}px; border: 2px dashed lime; cursor: move;"></div>
    </div>
  </div>
</div>
{% endblock %}
